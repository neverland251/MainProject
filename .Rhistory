qnorm(z,0,1)
qnorm(Z,0,1)
Z <- tau / ((2/9)*((2*n+1)/(n*(n-1))))^(1/2)
qnorm(Z,0,1)
Z
qnorm(4,0,1)
qnorm(2,0,1)
qnorm(1,0,1)
qnorm(1,mu=0,sd=1)
qnorm(1,mean=0,sd=1)
qnorm
?qnorm
pnorm(1,0,1)
pnorm(Z,0,1)
1 - pnorm(Z,0,1)
rs <- (sum((rank(x_1500) - (n+1)/2) * (rank(y_maraton) - (n+1)/2)))/(n*(n^2-1)/12)
rs
rs/(1/(n-1))
rs/(1/(n-1))^(1/2)
1 - pnorm(Z_rs,0,1)
Z_rs <- rs/(1/(n-1))^(1/2)
1 - pnorm(Z_rs,0,1)
plot(x_1500,y_maraton)
X_y <- data.frame(x_1500,y_maraton)
x_y
X_y
ggplot(X_y,aes(x=x_1500,y=y_maraton))
library("ggplot")
X_y <- data.frame(x_1500,y_maraton)
ggplot(X_y,aes(x=x_1500,y=y_maraton))
library("ggplot2")
X_y <- data.frame(x_1500,y_maraton)
ggplot(X_y,aes(x=x_1500,y=y_maraton))
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point()
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text()
rownames(X_y)
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y))
?geom_text
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x = 0.5)
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_y= 0.5)
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_y= 1)
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 1)
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2)
ww
install.packages("Rfit")
n <- length(y)
## (1)라오-크래머 하한을 만족하는 윌콕슨 점수 함수 : root(12) * ((y순서통계량/n-1) * 1/2))
## 우선 정규화를 위한 피벗을 만들기 위해, 분자에 들어가는 값인 윌콕슨 t를 먼저 구해준다.
fun <- 12^(1/2)*((rank(y)/(n-1))-(1/2))
wilcoxn_t <- sum((x-mean(x))*fun)
Sa <- sum(fun)
var <- sum((x-mean(x))^2) * Sa^2 * (n-1)^(-1)
rm(var)
var_t <- sum((x-mean(x))^2) * Sa^2 * (n-1)^(-1)
Z_t <- wilcoxn_t/var_t^(1/2)
Z_t
pnorm(Z_t,0,1)
1 - pnorm(Z_t,0,1)
b <- sum(y*(x-mean(x)))/sum((x-mean(x))^2)
b <- sum(y_maraton*(x_1500-mean(x_1500)))/sum((x_1500-mean(x_1500))^2)
b
lm(y_maraton~x_1500)
mean(y_maraton)
a <- mean(y_maraton)
glm(y_maraton~x_1500)
-2598 + 19.6 * (y_maraton)
-2598 + (19.6 * (x_1500 - mean(x_1500)))
2598 + (19.6 * (x_1500 - mean(x_1500)))
mean(y_maraton) + (19.6 * (x_1500 - mean(x_1500)))
mean(y_maraton)/10 + (19.6 * (x_1500 - mean(x_1500)))
mean(y_maraton) + (19.6 * (x_1500 - mean(x_1500)))
-mean(y_maraton) + (19.6 * (x_1500 - mean(x_1500)))
lm(y_maraton ~ x_1500)
z_lm <- lm(y_maraton ~ x_1500)
z_lm <- lm(y_maraton ~ x_1500)
library("Rfit")
?ww
?WW
library("Rft")
library("Rfit")
?rfit
z_wilcoxon <- rfit(y_maraton~x_1500,scores = wscores)
z_wilcoxon
str(z)
str(z_wilcoxon)
z_wilcoxon$fitted.values
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2) + geom_line(z_wilcoxon$fitted.values)
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2) + geom_line(aes(y=z_wilcoxon$fitted.values))
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2) + geom_line(aes(y=z_wilcoxon$fitted.values)) + geom_line(aes(y = z_lm))
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2) + geom_line(aes(y=z_wilcoxon$fitted.values)) + geom_line(aes(y = z_lm$fitted.values))
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2) + geom_line(aes(y=z_wilcoxon$fitted.values),color = red) + geom_line(aes(y = z_lm$fitted.values))
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2) + geom_line(aes(y=z_wilcoxon$fitted.values),color = "red") + geom_line(aes(y = z_lm$fitted.values))
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2) + geom_line(aes(y=z_wilcoxon$fitted.values),color = "red") + geom_line(aes(y = z_lm$fitted.values),color = blue)
ggplot(X_y,aes(x=x_1500,y=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2) + geom_line(aes(y=z_wilcoxon$fitted.values),color = "red") + geom_line(aes(y = z_lm$fitted.values),color = "blue")
y_maraton
z_lm <- lm(x_1500 ~ y_maraton)
z_lm
z_wilcoxon <- rfit(x_1500~y_maraton,scores = wscores)
ggplot(X_y,aes(y=x_1500,x=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2) + geom_line(aes(x=z_wilcoxon$fitted.values),color = "red") + geom_line(aes(x = z_lm$fitted.values),color = "blue")
ggplot(X_y,aes(y=x_1500,x=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2) + geom_line(aes(y=z_wilcoxon$fitted.values),color = "red") + geom_line(aes(y = z_lm$fitted.values),color = "blue")
y_1500 <- c(373.2,246,245.4,252,243,236.8,241.8,233.6,233.2,231.2,227.8,229.8,225.2,221.2,215.6,218.1,214.9,216.3,219.2,218.4)
x_maraton <- c(3530,3585,5333,3084,3318,2215,1956,2483,1977,1896,1759,2092,1383,1500,916,731,1226,740,595,663)
## 1) 단순선형회귀와 윌콕슨 선형회귀를 각각 적합해준다.
b <- sum(x_maraton*(y_1500-mean(y_1500)))/sum((y_1500-mean(y_1500))^2)
b
## 1) 단순선형회귀와 윌콕슨 선형회귀를 각각 적합해준다.
b <- sum(y_1500*(y_maraton-mean(x_maraton)))/sum((x_maraton-mean(x_maraton))^2)
b
a <- mean(y_1500)
a
ggplot(X_y,aes(y=x_1500,x=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_x= 2) + geom_line(aes(y=z_wilcoxon$fitted.values),color = "red") + geom_line(aes(y = z_lm$fitted.values),color = "blue")
ggplot(X_y,aes(y=x_1500,x=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_y= 2) + geom_line(aes(y=z_wilcoxon$fitted.values),color = "red") + geom_line(aes(y = z_lm$fitted.values),color = "blue")
ggplot(X_y,aes(y=x_1500,x=y_maraton)) + geom_point() + geom_text(label = rownames(X_y),nudge_y= 4) + geom_line(aes(y=z_wilcoxon$fitted.values),color = "red") + geom_line(aes(y = z_lm$fitted.values),color = "blue")
x <- c(-9,58,12,-1,-37,0,11,21,18,-24,-4,-59,-9,9,8)
x
x[x == -59]
x == -59
rank(x == 59)
index(x == 59)
x[12]
x[12] <- -53
x
rep(-300:300)
?rep
rep(-300,300,each=10)
rep(-300,300,len=10)
rep(-300,300,times=10)
seq(-300:300,by=10)
seq(-300,300,by=10)
length(x)
x[16]
x[15]
x
rbind(x,c(10))
cbind(x,c(10))
bind(x,c(10))
c(x,c(10))
c(x,c(9))
for(i in seq(-300,300,by=10)){
x_abnom <- x[length(x)+1] <- i
a <- (mean(x) - mean(x_abnom))/(1/(length(x)+1))
sensi <- c(sensi,c(a))
}
sensi <- c()
for(i in seq(-300,300,by=10)){
x_abnom <- x[length(x)+1] <- i
a <- (mean(x) - mean(x_abnom))/(1/(length(x)+1))
sensi <- c(sensi,c(a))
}
sensi
x_abnom
x_abnom
x
for(i in seq(-300,300,by=10)){
x <- c(-9,58,12,-1,-37,0,11,21,18,-24,-4,-59,-9,9,8)
x_abnom <- x[length(x)+1] <- i
a <- (mean(x) - mean(x_abnom))/(1/(length(x)+1))
sensi <- c(sensi,c(a))
}
x_abnom
x
i
x <- c(-9,58,12,-1,-37,0,11,21,18,-24,-4,-59,-9,9,8)
sensi <- c()
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- (mean(x) - mean(x_abnom))/(1/(length(x)+1))
sensi <- c(sensi,c(a))
}
x_abnom
a
sensi
mean(x)
mean(x_abnom)
(mean(x) - mean(x_abnom))/(1/(length(x)+1))
(1/(length(x)+1))
x_abnom - mean(x)
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- (mean(x_abnom) - mean(x))/(1/(length(x)+1))
sensi <- c(sensi,c(a))
}
sensi
sensi
data.frame(sensi)
data.frame("sensi" = sensi)
sensi <- data.frame("sensi" = sensi)
sensi <- data.frame("sensi" = sensi,"abnom" = sep(-300,300,by=10))
sensi <- data.frame("sensi" = sensi,"abnom" = c(sep(-300,300,by=10)))
sensi <- data.frame("sensi" = sensi,"abnom" = seq(-300,300,by=10))
ggplot(sensi,aes(x = "abnom",y="sensi"))
library("ggplot")
ggplot(sensi,aes(x = "abnom",y="sensi"))
library("ggplot2")
ggplot(sensi,aes(x = "abnom",y="sensi"))
ggplot(sensi,aes(x = "abnom",y="sensi")) + geom_line()
?geom_line
ggplot(sensi,aes(x = "abnom",y="sensi")) + geom_line()
?geom_line
sensi
ggplot(sensi,aes(x = "abnom",y="sensi")) + geom_path()
ggplot(sensi,aes(x = "abnom",y="sensi")) + geom_point()
sensi
sensi["abnom"]
?ggplot
ggplot(sensi) + geom_point(aes(x = "abnom",y="sensi"))
?ggplot
ggplot(sensi,aes(x = "abnom",y="sensi")) + geom_hisogram()
ggplot(sensi,aes(x = "abnom",y="sensi")) + geom_hist()
ggplot(sensi,aes(x = "abnom",y="sensi")) + geom_line()
sensi
sensi <- data.frame("sensi" = sensi,"abnom" = seq(-300,300,by=10))
sensi
sensi <- c()
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- (mean(x_abnom) - mean(x))/(1/(length(x)+1))
sensi <- c(sensi,c(a))
}
sensi <- data.frame("sensi" = sensi,"abnom" = seq(-300,300,by=10))
sensi
ggplot(sensi,aes(x = "abnom",y="sensi")) + geom_line()
sensi
ggplot(sensi,aes(x = "abnom",y="sensi")) + geom_point()
ggplot(sensi,aes(x = "sensi",y="abnom")) + geom_point()
plot(sensi)
ggplot(sensi + geom_point()
ggplot(sensi) + geom_point()
ggplot(sensi) + geom_point()
plot(sensi)
plot(sensi,sensi)
ggplot(sensi,aes(x="abnom",y="sensi")) + geom_point()
ggplot(sensi,aes(x="abnom",y="sensi")) + geom_line()
ggplot(sensi,aes(x="abnom",y="sensi")) + geom_line()
?geom_line()
ggplot(sensi,aes(x="abnom",y="sensi")) +geom_point()+ geom_line()
?ggplot
ggplot(sensi,aes(x="abnom",y="sensi")) +geom_point(data=sensi) + geom_line()
ggplot(sensi,aes(x="abnom",y="sensi"))
sensi
ggplot(sensi,aes(x="abnom",y="sensi")) + geom_point()
plot(sensi)
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- (median(x_abnom) - median(x))/(1/(length(x)+1))
sensi <- c(sensi,c(a))
}
sensi
sensi <- c()
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- (mean(x_abnom) - mean(x))/(1/(length(x)+1))
sensi <- c(sensi,c(a))
}
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- (median(x_abnom) - median(x))/(1/(length(x)+1))
sensi_median <- c(sensi,c(a))
}
sensi_median
sensi_median <- data.frame("sensi" = sensi_median,"abnom" = seq(-300,300,by=10))
sensi_median
x
a
sensi_median
sensi_median <- c()
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- (median(x_abnom) - median(x))/(1/(length(x)+1))
sensi_median <- c(sensi,c(a))
}
sensi_median <- data.frame("sensi" = sensi_median,"abnom" = seq(-300,300,by=10))
sensi_median
length(sensi_median)
length(seq(-300,300,by=10))
sensi_median <- c()
x_abnom <- c(x,c(i))
a <- (median(x_abnom) - median(x))/(1/(length(x)+1))
sensi_median <- c(sensi,c(a))
median(x_abnom)
x_abnom
median(x)
sensi_median
i
sensi_median["abnom"]
(median(x_abnom) - median(x))
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- (median(x_abnom) - median(x))/(1/(length(x)+1))
sensi_median <- c(sensi_median,c(a))
}
sensi_median <- data.frame("sensi" = sensi_median,"abnom" = seq(-300,300,by=10))
sensi_median <- c()
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- (median(x_abnom) - median(x))/(1/(length(x)+1))
sensi_median <- c(sensi_median,c(a))
}
sensi_median <- data.frame("sensi" = sensi_median,"abnom" = seq(-300,300,by=10))
plot(sensi_median)
plot(sensi,sensi_median)
sensi
length(sensi)
length(sensi_median)
length(sensi_median)
sensi_median
sensi
sensi <- c()
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- (mean(x_abnom) - mean(x))/(1/(length(x)+1))
sensi <- c(sensi,c(a))
}
sensi <- data.frame("sensi" = sensi,"abnom" = seq(-300,300,by=10))
plot(sensi,sensi_median)
plot(c(sensi,sensi_median))
rbind(sensi,sensi_median)
cbind(sensi,sensi_median)
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- c()
for(j in seq(1,length(x_abnom))){
for(k in seq(1,(j-1))){
a[j] <- (x_abnom[k] + x_abnom[j])/2
}
b_abnom <- median(a)
}
a <- c()
for(j in seq(1,length(x))){
for(k in seq(1,(j-1))){
a[j] <- (x[k] + x[j])/2
}
b <- median(a)
}
a <- (b_abnom - b)/(1/(length(x)+1))
sensi_hodges <- c(sensi_hodges,c(b))
}
k
seq(1,(j-1))
j
rep(1:0)
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- c()
for(j in seq(1,length(x_abnom))){
if(j != 1){
for(k in seq(1,(j-1))){
a[j] <- (x_abnom[k] + x_abnom[j])/2
}
b_abnom <- median(a)
}
}
a <- c()
for(j in seq(1,length(x))){
if(j != 1){
for(k in seq(1,(j-1))){
a[j] <- (x[k] + x[j])/2
}
}
b <- median(a)
}
a <- (b_abnom - b)/(1/(length(x)+1))
sensi_hodges <- c(sensi_hodges,c(b))
}
sensi_hodges <- c()
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- c()
for(j in seq(1,length(x_abnom))){
if(j != 1){
for(k in seq(1,(j-1))){
a[j] <- (x_abnom[k] + x_abnom[j])/2
}
b_abnom <- median(a)
}
}
a <- c()
for(j in seq(1,length(x))){
if(j != 1){
for(k in seq(1,(j-1))){
a[j] <- (x[k] + x[j])/2
}
}
b <- median(a)
}
a <- (b_abnom - b)/(1/(length(x)+1))
sensi_hodges <- c(sensi_hodges,c(b))
}
sensi_hodges
a
b_abnom
j
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- c()
for(j in seq(1,length(x_abnom))){
for(k in seq(1,j)){
a[j] <- (x_abnom[k] + x_abnom[j])/2
}
b_abnom <- median(a)
}
a <- c()
for(j in seq(1,length(x))){
for(k in seq(1,(j-1))){
a[j] <- (x[k] + x[j])/2
}
b <- median(a)
}
a <- (b_abnom - b)/(1/(length(x)+1))
sensi_hodges <- c(sensi_hodges,c(b))
}
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- c()
for(j in seq(1,length(x_abnom))){
for(k in seq(1,j)){
a[j] <- (x_abnom[k] + x_abnom[j])/2
}
b_abnom <- median(a)
}
a <- c()
for(j in seq(1,length(x))){
for(k in seq(1,j)){
a[j] <- (x[k] + x[j])/2
}
b <- median(a)
}
a <- (b_abnom - b)/(1/(length(x)+1))
sensi_hodges <- c(sensi_hodges,c(b))
}
sensi_hodges
sensi_hodges <- c()
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- c()
for(j in seq(1,length(x_abnom))){
for(k in seq(1,j)){
a[j] <- (x_abnom[k] + x_abnom[j])/2
}
b_abnom <- median(a)
}
a <- c()
for(j in seq(1,length(x))){
for(k in seq(1,j)){
a[j] <- (x[k] + x[j])/2
}
b <- median(a)
}
a <- (b_abnom - b)/(1/(length(x)+1))
sensi_hodges <- c(sensi_hodges,c(b))
}
a
a
b
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- c()
for(j in seq(1,length(x_abnom))){
for(k in seq(1,j)){
a[j] <- (x_abnom[k] + x_abnom[j])/2
}
b_abnom <- median(a)
}
a1 <- c()
for(j in seq(1,length(x))){
for(k in seq(1,j)){
a[j] <- (x[k] + x[j])/2
}
b <- median(a)
}
a1 <- (b_abnom - b)/(1/(length(x)+1))
sensi_hodges <- c(sensi_hodges,c(b))
}
a
x
x_abnom
j
k
b_abnom
b
sensi_hodges
sensi_hodges <- c()
for(i in seq(-300,300,by=10)){
x_abnom <- c(x,c(i))
a <- c()
for(j in seq(1,length(x_abnom))){
for(k in seq(1,j)){
a[j] <- (x_abnom[k] + x_abnom[j])/2
}
b_abnom <- median(a)
}
a1 <- c()
for(j in seq(1,length(x))){
for(k in seq(1,j)){
a[j] <- (x[k] + x[j])/2
}
b <- median(a)
}
a1 <- (b_abnom - b)/(1/(length(x)+1))
sensi_hodges <- c(sensi_hodges,c(b))
}
sensi_hodges
sensi_hodges <- data.frame("sensi" = sensi_hodges,"abnom" = seq(-300,300,by=10))
plot(sensi_hodges)
plot(sensi_hodges.T)
plot(transpose(sensi_hodges))
plot(t(sensi_hodges))
plot(sensi_hodges)
plot(sensi_median)
plot(sensi)
plot(sensi_hodges)
plot(sensi_median)
